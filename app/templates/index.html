{% extends "base.html" %}

{% block app_content %}
<!--<h1>Salut, ##{{ current_user.username }}!</h1>-->

<label for="numbercitation">Choisir un numero de citation:</label>

<input type="number" id="numbercitation" name="numbercitation"
       min="1" max="300">


<button type="button" id="Run">Load</button>

<!--<div style="height:300px; display: table-cell; vertical-align: middle; text-align: center">
    <h2 id="ShowCitation"></h2>
</div>-->

<div style="height:300px; padding: 70px 0; text-align: justify">
    <h2 id="ShowCitation"></h2>
</div>



<div style="height:50px;">
    <h4 id="ShowSRRandTRT"> </h4>
</div>


<!--<br />-->
<footer>

    <button type="button" style="height:100px;width:33%" id="Plusone">+1</button>
    <button type="button" style="height:100px;width:33%" id="Suivant">Suivant</button>
    <button type="button" style="height:100px;width:33%" id="Minusone">-1</button>


</footer>
<!--<div class="container">
    <table class="table table-striped table-bordered table-hover table-condensed">
        <thead>
            <tr>
                <th>#</th>
                <th>Citation</th>
                <th>SRR</th>
                <th>TRT</th>
            </tr>
        </thead>
        <tbody>
            {% for citation in citations %}
            {% include '_post.html' %}
            {% endfor %}
        </tbody>
    </table>
</div>-->
{% endblock %}


{% block scripts %}
{{ super() }}
<script>

    $(function () {
        // write start up code here
        var iteration
        var citations
        var firstTimestamp
        var secondTimestamp

        $("#Run").click(function () {


            iteration = 1;
            variable = Number($('#numbercitation').val());


            $.ajax({
                url: '/RequestCitations',
                type: 'POST',
                data: JSON.stringify(variable),
                success: function (dicts) {
                    citations = dicts;
                    $("#ShowCitation").css({ "font-size": "60px", "text-align": "center" });
                    $("#ShowCitation").html(citations[iteration][0]);

                }
            });

            firstTimestamp = new Date().getTime();
            $('#Suivant').attr("disabled", "disabled")
            $("#ShowSRRandTRT").html('')
        });
        $("#Plusone").click(function () {

            secondTimestamp = new Date().getTime();
            NewTRT = Math.floor((secondTimestamp - firstTimestamp) / 1000);
            CurrentCitationNumber = citations[iteration][0]
            NewSRR = parseInt(citations[iteration][2]) + 1
            citations[iteration][2] = NewSRR.toString()

            $.ajax({
                url: '/SaveTrainingResults',
                type: 'POST',
                data: JSON.stringify({ 'CurrentCitationNumber': CurrentCitationNumber, 'NewSRR': NewSRR, 'NewTRT': NewTRT }),
                success: function (saved) {
                    //alert(saved);
                    $("#ShowSRRandTRT").html('New SRR= ' + saved[0] + '; New TRT= ' + saved[1])

                }
            });
            $("#ShowCitation").html(citations[iteration][1]);
            $("#ShowCitation").removeAttr('style');
            $('#Suivant').removeAttr('disabled');

        });

        $("#Suivant").click(function () {
            iteration = iteration + 1;
            firstTimestamp = new Date().getTime();
            //$("#ShowCitation").html(citations.keys()[iteration]);
            $("#ShowCitation").html(citations[iteration][0]);
            $("#ShowCitation").css({ "font-size": "60px", "text-align": "center" })
            $('#Suivant').attr("disabled", "disabled")
            $("#ShowSRRandTRT").html('')
        });

    });
</script>
{% endblock %}



